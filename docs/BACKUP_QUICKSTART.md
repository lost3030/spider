# æ•°æ®åº“å¤‡ä»½åŠŸèƒ½ - å¿«é€ŸæŒ‡å—

## âœ… å·²å®Œæˆçš„é…ç½®

### 1. å¤‡ä»½è„šæœ¬
- ğŸ“„ `scripts/backup_databases.py` - ä¸»å¤‡ä»½è„šæœ¬
- ğŸ“„ `scripts/run_backup.bat` - Windows å¿«é€Ÿè¿è¡Œè„šæœ¬

### 2. Crontab å®šæ—¶ä»»åŠ¡
```cron
# æ¯å¤©å‡Œæ™¨2ç‚¹è¿è¡Œå¤‡ä»½
0 2 * * * root cd /app && /usr/local/bin/python /app/scripts/backup_databases.py >> /app/logs/backup.log 2>&1
```

### 3. å¤‡ä»½ç­–ç•¥
- â° **è¿è¡Œæ—¶é—´**: æ¯å¤©å‡Œæ™¨ 2:00
- ğŸ“ **å¤‡ä»½ä½ç½®**: `data/backups/`
- ğŸ“… **æ–‡ä»¶å‘½å**: `æ•°æ®åº“å_YYYYMMDD.db`
- ğŸ”„ **ä¿ç•™æ•°é‡**: æœ€æ–° 3 ä¸ªå¤‡ä»½
- ğŸ—‘ï¸ **è‡ªåŠ¨æ¸…ç†**: åˆ é™¤ç¬¬ 4 ä¸ªåŠæ›´æ—§çš„å¤‡ä»½

### 4. å¤‡ä»½æ•°æ®åº“
- `data/twitter.db` â†’ `data/backups/twitter_YYYYMMDD.db`
- `data/twitter_ai.db` â†’ `data/backups/twitter_ai_YYYYMMDD.db`
- `data/mofcom.db` â†’ `data/backups/mofcom_YYYYMMDD.db`

---

## ğŸš€ å¿«é€Ÿä½¿ç”¨

### æ‰‹åŠ¨å¤‡ä»½ï¼ˆæµ‹è¯•ï¼‰
```powershell
# è¿è¡Œå¤‡ä»½
python scripts\backup_databases.py

# æˆ–ä½¿ç”¨æ‰¹å¤„ç†
.\scripts\run_backup.bat
```

### æŸ¥çœ‹å¤‡ä»½æ–‡ä»¶
```powershell
Get-ChildItem data\backups\*.db | Format-Table Name, Length, LastWriteTime -AutoSize
```

### æŸ¥çœ‹å¤‡ä»½æ—¥å¿—ï¼ˆDockerï¼‰
```bash
docker exec spider tail -f /app/logs/backup.log
```

---

## ğŸ“Š æµ‹è¯•ç»“æœ

åˆšæ‰çš„æµ‹è¯•è¿è¡ŒæˆåŠŸï¼š
```
============================================================
æ•°æ®åº“å¤‡ä»½ä»»åŠ¡
============================================================
[INFO] æ—¶é—´: 2026-01-12 11:09:55
[INFO] ä¿ç•™æœ€æ–° 3 ä¸ªå¤‡ä»½

[INFO] å¤‡ä»½ç›®å½•: data\backups
[INFO] å¤‡ä»½æˆåŠŸ: twitter_20260112.db (76.0 KB)
[INFO] å¤‡ä»½æˆåŠŸ: twitter_ai_20260112.db (68.0 KB)
[INFO] å¤‡ä»½æˆåŠŸ: mofcom_20260112.db (32.0 KB)

[INFO] å¤‡ä»½å®Œæˆï¼æˆåŠŸ 3/3 ä¸ªæ•°æ®åº“
============================================================
```

---

## ğŸ“ å®šæ—¶ä»»åŠ¡æ€»è§ˆ

ç°åœ¨ Docker ä¸­è¿è¡Œçš„å®šæ—¶ä»»åŠ¡ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å®šæ—¶ä»»åŠ¡                                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. å•†åŠ¡éƒ¨çˆ¬è™«        - æ¯10åˆ†é’Ÿ                          â”‚
â”‚ 2. Twitter å®Œæ•´æµæ°´çº¿ - æ¯10åˆ†é’Ÿï¼ˆçˆ¬å–+AI+é€šçŸ¥ï¼‰         â”‚
â”‚ 3. æ•°æ®åº“å¤‡ä»½        - æ¯å¤©å‡Œæ™¨2ç‚¹ â­ æ–°å¢               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”’ æ•°æ®å®‰å…¨

### å¤šå±‚ä¿æŠ¤
1. âœ… **ä¸»æ•°æ®åº“**: `data/twitter.db`
2. âœ… **å¤‡ä»½1**: `data/backups/twitter_20260112.db`
3. âœ… **å¤‡ä»½2**: `data/backups/twitter_20260111.db`
4. âœ… **å¤‡ä»½3**: `data/backups/twitter_20260110.db`

### Volume æŒä¹…åŒ–ï¼ˆDockerï¼‰
```yaml
volumes:
  - ./data:/app/data  # åŒ…æ‹¬ä¸»æ•°æ®åº“å’Œå¤‡ä»½
```

æœ¬åœ°å’Œ Docker å…±äº«åŒä¸€ä»½æ•°æ®å’Œå¤‡ä»½ï¼

---

## ğŸ“š è¯¦ç»†æ–‡æ¡£

å®Œæ•´è¯´æ˜è¯·æŸ¥çœ‹ï¼š`docs/BACKUP.md`

åŒ…å«ï¼š
- ğŸ“– è¯¦ç»†é…ç½®è¯´æ˜
- ğŸ”„ æ•°æ®æ¢å¤æ­¥éª¤
- ğŸ§ª æµ‹è¯•æ–¹æ³•
- âš ï¸ æ³¨æ„äº‹é¡¹
- ğŸ”§ æ•…éšœæ’é™¤

---

## âœ¨ åŠŸèƒ½äº®ç‚¹

- âœ… è‡ªåŠ¨å¤‡ä»½ï¼Œæ— éœ€äººå·¥å¹²é¢„
- âœ… æ™ºèƒ½æ¸…ç†ï¼Œé˜²æ­¢ç£ç›˜çˆ†æ»¡
- âœ… æ—¥æœŸå‘½åï¼Œä¸€ç›®äº†ç„¶
- âœ… è¯¦ç»†æ—¥å¿—ï¼Œæ–¹ä¾¿æ’æŸ¥
- âœ… æœ¬åœ°å’Œ Docker é€šç”¨

**æ•°æ®å®‰å…¨æœ‰ä¿éšœï¼** ğŸ”âœ¨
